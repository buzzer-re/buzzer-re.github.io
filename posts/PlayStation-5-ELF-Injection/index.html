<!DOCTYPE html>









<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en"
  
    data-mode="dark"
  
>

  <!-- The Head -->

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  >

  
    

    
  

  

  

  
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Usermode ELF injection on the PlayStation 5" />
<meta property="og:locale" content="en" />
<meta name="description" content="ELF injection is crucial for developing complex homebrew applications, helping with debugging and instrumentation during security research, and specially for extending application capabilities, such as enhancing the UI or creating internal mods for your favorite games." />
<meta property="og:description" content="ELF injection is crucial for developing complex homebrew applications, helping with debugging and instrumentation during security research, and specially for extending application capabilities, such as enhancing the UI or creating internal mods for your favorite games." />
<link rel="canonical" href="https://reversing.codes/posts/PlayStation-5-ELF-Injection/" />
<meta property="og:url" content="https://reversing.codes/posts/PlayStation-5-ELF-Injection/" />
<meta property="og:site_name" content="Reversing codes" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-09-03T00:00:00-03:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Usermode ELF injection on the PlayStation 5" />
<meta name="twitter:site" content="@buzz3r_" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-09-03T12:41:29-03:00","datePublished":"2025-09-03T00:00:00-03:00","description":"ELF injection is crucial for developing complex homebrew applications, helping with debugging and instrumentation during security research, and specially for extending application capabilities, such as enhancing the UI or creating internal mods for your favorite games.","headline":"Usermode ELF injection on the PlayStation 5","mainEntityOfPage":{"@type":"WebPage","@id":"https://reversing.codes/posts/PlayStation-5-ELF-Injection/"},"url":"https://reversing.codes/posts/PlayStation-5-ELF-Injection/"}</script>
<!-- End Jekyll SEO tag -->

  

  <title>Usermode ELF injection on the PlayStation 5 | Reversing codes
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">
<link rel="manifest" href="/assets/img/favicons/site.webmanifest">
<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Reversing codes">
<meta name="application-name" content="Reversing codes">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      <link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin>
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
    

    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">
  

  <!-- GA -->
  

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.1/css/all.min.css">

  <link rel="stylesheet" href="/assets/css/style.css">

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.css">
  

  
    <!-- Manific Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css">
  

  <!-- JavaScript -->

  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.1/dist/jquery.min.js"></script>

  
</head>


  <body data-topbar-visible="true">

    <!--
  The Side Bar
-->
<style>
  body {
      text-align: justify;
  }
  </style>
  
<div id="sidebar" class="d-flex flex-column align-items-end">
  <div class="profile-wrapper text-center">
    <div id="avatar">
      <a href="/" class="mx-auto">
        
          
          <img src="https://avatars.githubusercontent.com/u/22428720" alt="avatar" onerror="this.style.display='none'">
        
      </a>
    </div>

    <div class="site-title">
      <a href="/">Buzzer's blog</a>
    </div>
    <div class="site-subtitle font-italic">Security Researcher & Dreamer</div>

  </div><!-- .profile-wrapper -->

  <ul class="w-100">

    <!-- home -->
    <li class="nav-item">
      <a href="/" class="nav-link">
        <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i>
        <span>HOME</span>
      </a>
    </li>
    <!-- the real tabs -->
    
    <li class="nav-item">
      <a href="/categories/" class="nav-link">
        <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>CATEGORIES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/tags/" class="nav-link">
        <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>TAGS</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/archives/" class="nav-link">
        <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>ARCHIVES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/about/" class="nav-link">
        <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>ABOUT</span>
      </a>
    </li> <!-- .nav-item -->
    

  </ul> <!-- ul.nav.flex-column -->

  <div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center">

    

    
      

      
      <a href="https://github.com/buzzer-re" aria-label="github"
        
        
          
          target="_blank"
        

        

        rel="noopener">
        <i class="fab fa-github"></i>
      </a>
      

    
      

      
      <a href="https://twitter.com/buzz3r_" aria-label="twitter"
        
        
          
          target="_blank"
        

        

        rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
      

    
      

      
      <a href="/feed.xml" aria-label="rss"
        
        

        

        >
        <i class="fas fa-rss"></i>
      </a>
      

    

  </div> <!-- .sidebar-bottom -->

      <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-V8QSGFHYFB"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());
        id = 'G-V8QSGFHYFB'
        gtag('config', id);
    </script>
</div><!-- #sidebar -->


    <!--
  The Top Bar
-->

<div id="topbar-wrapper">
  <div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4">
    <span id="breadcrumb">

    

    

      

        
          <span>
            <a href="/">
              Home
            </a>
          </span>

        

      

        

      

        

          
            <span>Usermode ELF injection on the PlayStation 5</span>
          

        

      

    

    </span><!-- endof #breadcrumb -->

    <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i>

    <div id="topbar-title">
      Post
    </div>

    <i id="search-trigger" class="fas fa-search fa-fw"></i>
    <span id="search-wrapper" class="align-items-center">
      <i class="fas fa-search fa-fw"></i>
      <input class="form-control" id="search-input" type="search"
        aria-label="search" autocomplete="off" placeholder="Search...">
    </span>
    <span id="search-cancel" >Cancel</span>
  </div>

</div>


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div id="main" class="container pl-xl-4 pr-xl-4">
        





<div class="row">

  <!-- core -->
  <div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4">
    <div class="post pl-1 pr-1 pl-md-2 pr-md-2">

    

    
      
      
        <!--
  Refactor the HTML structure.
-->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->


<!-- images -->




  
  

  <!-- CDN URL -->
  

  <!-- Add image path -->
  

  
    
      
      
    

    
    

    

    
    

    
    
    
    

    
      

      
      
      

      

    
      

      
      
      

      

    

    <!-- take out classes -->
    

    

    

    

    <!-- lazy-load images <https://github.com/aFarkas/lazysizes#readme> -->
    
    

    <!-- add image placeholder -->
    
      
    

    <!-- Bypass the HTML-proofer test -->
    

    <!-- make sure the `<img>` is wrapped by `<a>` -->
    

    
      <!-- create the image wrapper -->
      
    

    <!-- combine -->
    

  
    

    
    

    

    
    

    
    
    
    

    
      

      
      
      

      

    
      

      
      
      

      

    

    <!-- take out classes -->
    

    

    

    

    <!-- lazy-load images <https://github.com/aFarkas/lazysizes#readme> -->
    
    

    <!-- add image placeholder -->
    
      
    

    <!-- Bypass the HTML-proofer test -->
    

    <!-- make sure the `<img>` is wrapped by `<a>` -->
    

    
      <!-- create the image wrapper -->
      
    

    <!-- combine -->
    

  
    

    
    

    

    
    

    
    
    
    

    
      

      
      
      

      

    
      

      
      
      

      

    

    <!-- take out classes -->
    

    

    

    

    <!-- lazy-load images <https://github.com/aFarkas/lazysizes#readme> -->
    
    

    <!-- add image placeholder -->
    
      
    

    <!-- Bypass the HTML-proofer test -->
    

    <!-- make sure the `<img>` is wrapped by `<a>` -->
    

    
      <!-- create the image wrapper -->
      
    

    <!-- combine -->
    

  

  



<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    

    

  

  
  

  

  
  

  

  
  

  




<!-- return -->

<h1 data-toc-skip>Usermode ELF injection on the PlayStation 5</h1>

<div class="post-meta text-muted">
    <!-- published date -->
    <span>
      Posted
      <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em class=""
    data-ts="1756868400"
    data-df="ll"
    data-toggle="tooltip" data-placement="bottom">
  Sep  3, 2025
</em>

    </span>

    <!-- lastmod date -->
    
    <span>
      Updated
      <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em class=""
    data-ts="1756914089"
    data-df="ll"
    data-toggle="tooltip" data-placement="bottom">
  Sep  3, 2025
</em>

    </span>
    

  

  <div class="d-flex justify-content-between">
    <!-- author(s) -->
    <span>
      

      By

      <em>
      
        <a href="https://github.com/buzzer-re">Buzzer</a>
      
      </em>
    </span>

    <div>
      <!-- page views -->
      

      <!-- read time -->
      <!--
  Calculate the post's reading time, and display the word count in tooltip
 -->



<!-- words per minute  -->










<!-- return element -->
<span class="readtime" data-toggle="tooltip" data-placement="bottom"
  title="2480 words">
  <em>13 min</em> read</span>

    </div>

  </div> <!-- .d-flex -->

</div> <!-- .post-meta -->

<div class="post-content">
  <p>ELF injection is crucial for developing complex homebrew applications, helping with debugging and instrumentation during security research, and specially for extending application capabilities, such as enhancing the UI or creating internal mods for your favorite games.</p>

<p>There are a few protections and permission restrictions that prevent simple tasks, such as requesting executable memory pages in user mode (and in kernel mode too, but we’ll leave that for another post), using syscalls like <code class="language-plaintext highlighter-rouge">mmap</code>. The main reason for this is to prevent multistage shellcode execution, particularly after a ROP chain but directly after any kind of injection.</p>

<p>In this post, we’ll dive into the available methods to request executable memory in user mode, how an injection would work, and especially how to instrument the target process to essentially do everything for us. I’ll be using the <a href="https://github.com/buzzer-re/NineS/">9S</a> project as a showcase, since it’s the result of my research on the topic.</p>

<p>And yes, the project name is inspired on the <a href="https://nier.fandom.com/wiki/YoRHa_No.9_Type_S">YoRHa No.9 Type S</a> from Nier Automata, for the people who have played the game I’m sure you will understand the inspiration.</p>

<p>Also, inspired by my friend <a href="https://github.com/keowu">Kewou</a> <a href="https://keowu.re/posts/Rewriting-completely-the-GameSpy-support-from-2000-to-2004-using-Reverse-Engineering-on-EA-and-Bungie-Games">writings</a>, I’ll be leaving a <a href="https://www.youtube.com/watch?v=PslQESlD4xs">music</a> to listen while read the article.</p>

<hr />

<h2 id="playstation-5-overall-security"><span class="mr-2">PlayStation 5 Overall Security</span><a href="#playstation-5-overall-security" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Unlike its predecessor, the PS4, the PS5 has implemented several new protection measures that make certain tasks more difficult. In particular, the hypervisor prevents many types of modifications to the console firmware by proactively enforcing memory integrity and restricting access to low-level system features. This makes kernel-level exploitation and firmware patching significantly harder, even after achieving code execution in kernel space.</p>

<p>The hypervisor implement a feature called “XOM”(eXecute-Only-Memory), in short terms, it avoids that the <code class="language-plaintext highlighter-rouge">.text</code> can be read or written and can only be executed. Not only that, some techniques that envolve clear the <code class="language-plaintext highlighter-rouge">WP</code> bit from the <code class="language-plaintext highlighter-rouge">CR0</code> register are also useless, since modifiying such bits does generate an <code class="language-plaintext highlighter-rouge">vmexit</code> in the HV, that will endup by crashing the console for security (only the WP bit is protect, you can write in the others).</p>

<p>Another feature is the <code class="language-plaintext highlighter-rouge">SMEP</code>, on the <code class="language-plaintext highlighter-rouge">CR4</code>, which protects against execution of usermode pages in kernel mode. Modification/disable on this one also generate an <code class="language-plaintext highlighter-rouge">vmexit</code> in the HV.</p>

<p>Within this mechanisms, the PS5 also enforces the allocation RW pages in usermode using syscalls like the <code class="language-plaintext highlighter-rouge">mmap</code> syscall. Which means that even if you could ROP in usermode, you are unable (in theory) to request new RWX memory pages to execute any other thing.</p>

<p>This security features will be detailed in future articles, but this already gives you an idea of the overall difficulty of performing firmware level modifications that may allow the requesting of rwx memory in usermode or to modify any kind of process creation variables (patching the <code class="language-plaintext highlighter-rouge">exec</code> or <code class="language-plaintext highlighter-rouge">mmap</code>)</p>

<h2 id="current-exploit-and-primitives"><span class="mr-2">Current exploit and primitives</span><a href="#current-exploit-and-primitives" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>By time of the writing, there are currently at least 3 valid usermode entrypoint and 3 public kernel exploits. All of them were reported by different researchers into the PlayStation <a href="https://hackerone.com/playstation/hacktivity">HackerOne</a> profile. The last possible exploitable PS5 firmware is the <code class="language-plaintext highlighter-rouge">10.01</code>.</p>

<p>All exploits provides a RW primitives into the kernel, and that is enough to avoid all the security mechanisms that may avoid injection.</p>

<p>To write code into the PS5, I used the amazing <a href="https://github.com/ps5-payload-dev/sdk">SDK</a> currently available, that supports dynamic linking and wrappers to interact with the kernel’s read and write primitives.</p>

<h2 id="data-only-access"><span class="mr-2">Data-only access</span><a href="#data-only-access" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Many researchers from the PS5 console hacking scene have helped to find many offsets inside the <code class="language-plaintext highlighter-rouge">.data</code> section of the kernel, some assisted by decrypted firmware and others just using patterns into it. The .data section of the kernel is in fact unprotected by the HV for perfomance reasons. Since the PlayStation is mainly based on FreeBSD, it’s “easy” to figure out what one must do first if it want manipulate some process, which is to find the FreeBSD’s <a href="https://github.com/freebsd/freebsd-src/blob/676d64ee8327851063d92d0dd6a4ceee6b3a25e6/sys/sys/proc.h#L652">proc</a> structure.</p>

<h1 id="elevating-the-injector-process">Elevating the injector process</h1>

<p>To perform ELF injection, one has to at least have power over a process to be able to manipulate it’s state to create new threads inside it and to read and write into it’s memory (similar on how Windows’s injectors works). To achieve that, the <code class="language-plaintext highlighter-rouge">injector</code> tool must have the necessary permissions to at least call syscalls such as <code class="language-plaintext highlighter-rouge">ptrace</code>, as it’s crucial for instrumentation.</p>

<p>To do this, we need to manipulate the <code class="language-plaintext highlighter-rouge">proc</code> structure in FreeBSD, which contains many attributes of our process.</p>

<h2 id="manipulating-the-freebsds-proc-structure"><span class="mr-2">Manipulating the FreeBSD’s <strong><em>proc</em></strong> structure</span><a href="#manipulating-the-freebsds-proc-structure" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>The FreeBSD’s <a href="https://github.com/freebsd/freebsd-src/blob/676d64ee8327851063d92d0dd6a4ceee6b3a25e6/sys/sys/proc.h#L652">proc</a> structure is a linked list containing all current processes, it contains basic information such the PID and UID, also contains some Authentication ID’s, find the offset is trivial, once one has access to it can use the Kernel RW primitives to read the <code class="language-plaintext highlighter-rouge">proc</code> structure from the kernel <code class="language-plaintext highlighter-rouge">.data</code>.</p>

<div class="language-c highlighter-rouge"><div class="code-header">
        <span data-label-text="C"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre></td><td class="rouge-code"><pre><span class="k">struct</span> <span class="n">proc</span><span class="o">*</span> <span class="nf">find_proc_by_name</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">proc_name</span><span class="p">)</span>
<span class="p">{</span>

    <span class="kt">uint64_t</span> <span class="n">next</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">kernel_copyout</span><span class="p">(</span><span class="n">KERNEL_ADDRESS_ALLPROC</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">next</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">uint64_t</span><span class="p">));</span> <span class="c1">// 1</span>
    <span class="k">struct</span> <span class="n">proc</span><span class="o">*</span> <span class="n">proc</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">proc</span><span class="o">*</span><span class="p">)</span> <span class="n">malloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">proc</span><span class="p">));</span>
    <span class="k">do</span>
    <span class="p">{</span>
        <span class="n">kernel_copyout</span><span class="p">(</span><span class="n">next</span><span class="p">,</span> <span class="p">(</span><span class="kt">void</span><span class="o">*</span><span class="p">)</span> <span class="n">proc</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">proc</span><span class="p">));</span> <span class="c1">// 2</span>

        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">proc</span><span class="o">-&gt;</span><span class="n">p_comm</span><span class="p">,</span> <span class="n">proc_name</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">proc</span><span class="p">;</span>

        <span class="n">kernel_copyout</span><span class="p">(</span><span class="n">next</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">next</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">uint64_t</span><span class="p">));</span>

    <span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="n">next</span><span class="p">);</span>

    <span class="n">free</span><span class="p">(</span><span class="n">proc</span><span class="p">);</span>
    <span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>The example above was extract by a wrapper that I’ve <a href="https://github.com/buzzer-re/NineS/blob/main/src/proc.c">wrote</a> to interact with such kernel data structures, it will use the <code class="language-plaintext highlighter-rouge">kernel_copyout</code> function that encapuled the Read primitive from the kernel exploit, to extract the first entry of the <code class="language-plaintext highlighter-rouge">proc</code> linked list (1), therefore to read every entry it will need to also perform another Kernel read (2). When a give entry is found by some process name, it will return the copied <code class="language-plaintext highlighter-rouge">proc</code> structure.</p>

<p>It’s worth notice that with such wrappers, it’s easy to list all the current processes running in the system and it’s PIDs, as a matter of example here’s the code that does that (also in the same file):</p>

<div class="language-c highlighter-rouge"><div class="code-header">
        <span data-label-text="C"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="rouge-code"><pre><span class="kt">void</span> <span class="nf">list_all_proc_and_pid</span><span class="p">()</span>
<span class="p">{</span>

    <span class="kt">uint64_t</span> <span class="n">next</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">kernel_copyout</span><span class="p">(</span><span class="n">KERNEL_ADDRESS_ALLPROC</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">next</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">uint64_t</span><span class="p">));</span>
    <span class="k">struct</span> <span class="n">proc</span><span class="o">*</span> <span class="n">proc</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">proc</span><span class="o">*</span><span class="p">)</span> <span class="n">malloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">proc</span><span class="p">));</span>

    <span class="k">do</span>
    <span class="p">{</span>
        <span class="n">kernel_copyout</span><span class="p">(</span><span class="n">next</span><span class="p">,</span> <span class="p">(</span><span class="kt">void</span><span class="o">*</span><span class="p">)</span> <span class="n">proc</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">proc</span><span class="p">));</span>

        <span class="n">printf</span><span class="p">(</span><span class="s">"%s - %d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">proc</span><span class="o">-&gt;</span><span class="n">p_comm</span><span class="p">,</span> <span class="n">proc</span><span class="o">-&gt;</span><span class="n">pid</span><span class="p">);</span>

        <span class="n">kernel_copyout</span><span class="p">(</span><span class="n">next</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">next</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">uint64_t</span><span class="p">));</span>

    <span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="n">next</span><span class="p">);</span>

    <span class="n">free</span><span class="p">(</span><span class="n">proc</span><span class="p">);</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>The code is self explainatory, and it’s outputs the following text into the <a href="https://lists.freebsd.org/pipermail/freebsd-questions/2006-October/134233.html">klog</a>:</p>

<div class="table-wrapper"><table>
  <thead>
    <tr>
      <th style="text-align: center"><a href="/assets/images/playstation-5-elf-injection/list_procs.png" class="popup img-link "><img data-src="/assets/images/playstation-5-elf-injection/list_procs.png" alt="" class="lazyload" data-proofer-ignore></a></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">List of current running processes name, pid and the <code class="language-plaintext highlighter-rouge">proc</code> address entry in the kernel</td>
    </tr>
  </tbody>
</table></div>

<h2 id="elevating-process-privileges"><span class="mr-2">Elevating Process Privileges</span><a href="#elevating-process-privileges" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>The PlayStation <code class="language-plaintext highlighter-rouge">proc</code> structure is basically the same as the FreeBSD, but it does contains specific fields created for the console, such as the Authority ID which is added inside the <a href="https://web.mit.edu/freebsd/head/sys/sys/ucred.h">ucred</a> structure, which is part of the <code class="language-plaintext highlighter-rouge">struct proc</code>. This structure contains specific codes that describe a process permission of some resources or capabilities. In order to be able to debug remote process, which means use the <code class="language-plaintext highlighter-rouge">ptrace</code> and the <code class="language-plaintext highlighter-rouge">mdbg</code> syscall families (specific from the console), we need to add this permission into our process.</p>

<p>With R/W primitives the code that does that is pretty simple, and is the following:</p>

<div class="language-c highlighter-rouge"><div class="code-header">
        <span data-label-text="C"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre></td><td class="rouge-code"><pre><span class="c1">//</span>
<span class="c1">// Search process entr on the allproc linked list</span>
<span class="c1">// acquire the "ucred" structure and elevate it</span>
<span class="c1">//</span>
<span class="kt">void</span> <span class="nf">set_ucred_to_debugger</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">struct</span> <span class="n">proc</span><span class="o">*</span> <span class="n">proc</span> <span class="o">=</span> <span class="n">get_proc_by_pid</span><span class="p">(</span><span class="n">getpid</span><span class="p">());</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">proc</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">//</span>
        <span class="c1">// Parse process ucred</span>
        <span class="c1">//</span>
        <span class="k">struct</span> <span class="n">ucred</span> <span class="n">ucred</span><span class="p">;</span>
        <span class="n">bzero</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ucred</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">ucred</span><span class="p">));</span>
        <span class="c1">//</span>
        <span class="c1">// Read from kernel</span>
        <span class="c1">//</span>
        <span class="kt">uintptr_t</span> <span class="n">authid</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="kt">uintptr_t</span> <span class="n">ptrace_authid</span> <span class="o">=</span> <span class="n">PTRACE_AUTHID</span><span class="p">;</span>
        <span class="n">kernel_copyout</span><span class="p">((</span><span class="kt">uintptr_t</span><span class="p">)</span> <span class="n">proc</span><span class="o">-&gt;</span><span class="n">p_ucred</span> <span class="o">+</span> <span class="mh">0x58</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">authid</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">uintptr_t</span><span class="p">));</span>

        <span class="n">kernel_copyin</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ptrace_authid</span><span class="p">,</span> <span class="p">(</span><span class="kt">uintptr_t</span><span class="p">)</span> <span class="n">proc</span><span class="o">-&gt;</span><span class="n">p_ucred</span> <span class="o">+</span> <span class="mh">0x58</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">uintptr_t</span><span class="p">));</span>

        <span class="n">free</span><span class="p">(</span><span class="n">proc</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>The <code class="language-plaintext highlighter-rouge">authid</code> is located at offset <code class="language-plaintext highlighter-rouge">0x58</code> of the <code class="language-plaintext highlighter-rouge">ucred</code> structure. Using hardcoded offsets is not recommended, but as the kernel is not open source, and we cannot rely on the structure maintaining its layout. Therefore, it is common to maintain a reversed structure on the researcher’s side (using tools like IDA or Ghidra) and update the value as needed.</p>

<p>The <code class="language-plaintext highlighter-rouge">PTRACE_AUTHID</code> value is <code class="language-plaintext highlighter-rouge">0x4800000000010003</code>. After setting it, the process is permitted to use debug-related syscalls and functions, which will be explored in the following sections.</p>

<h1 id="requesting-usermode-executable-memory">Requesting usermode executable memory</h1>

<p>Now, if you want to inject something into a process, you have two options: either allocate remote executable memory within the target process or overwrite something inside it. In fact, my injector does both. As I wrote, it’s not possible to simply allocate memory pages with <code class="language-plaintext highlighter-rouge">PROT_EXEC|PROT_READ|PROT_WRITE</code>, but some processes, like browsers that use JIT to run JavaScript code, still need it.</p>

<p>Knowing this, the PS5 provides wrappers to specifically request JIT memory. These API calls are mostly used by browsers or any process that makes use of it (like the Redis server running in the background for caching).</p>

<p>In the first version of the injector and the SDK elfldr, it did exactly that. It used to run all the ELF inside JIT memory, which is not ideal because it requires more work to mirror the page.</p>

<h2 id="freebsds-vmmap-data-structure-overview"><span class="mr-2">FreeBSD’s vmmap data structure overview</span><a href="#freebsds-vmmap-data-structure-overview" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>FreeBSD keeps track of all process memory in a structure named <a href="https://man.freebsd.org/cgi/man.cgi?query=vm_map">vm_map</a>, which is a data structure of allocated pages for a process. It contains an element named <code class="language-plaintext highlighter-rouge">struct vm_map_entry header</code>, which is the entry point for all the pages. Internally, it uses two possible data structures: a double-linked list to perform linear searches and a <a href="https://en.wikipedia.org/wiki/Binary_search_tree">Binary-Search-Tree</a>.</p>

<p>Each page entry contains the following structure:</p>

<div class="language-c highlighter-rouge"><div class="code-header">
        <span data-label-text="C"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre></td><td class="rouge-code"><pre><span class="k">struct</span> <span class="n">vm_map_entry</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">vm_map_entry</span> <span class="o">*</span><span class="n">prev</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">vm_map_entry</span> <span class="o">*</span><span class="n">next</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">vm_map_entry</span> <span class="o">*</span><span class="n">left</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">vm_map_entry</span> <span class="o">*</span><span class="n">right</span><span class="p">;</span>
    <span class="n">vm_offset_t</span> <span class="n">start</span><span class="p">;</span>
    <span class="n">vm_offset_t</span> <span class="n">end</span><span class="p">;</span>
    <span class="n">vm_offset_t</span> <span class="n">avail_ssize</span><span class="p">;</span>
    <span class="n">vm_size_t</span> <span class="n">adj_free</span><span class="p">;</span>
    <span class="n">vm_size_t</span> <span class="n">max_free</span><span class="p">;</span>
    <span class="k">union</span> <span class="n">vm_map_object</span> <span class="n">object</span><span class="p">;</span>
    <span class="n">vm_ooffset_t</span> <span class="n">offset</span><span class="p">;</span>
    <span class="n">vm_eflags_t</span> <span class="n">eflags</span><span class="p">;</span>
    <span class="cm">/*	Only in	task maps: */</span>
    <span class="n">vm_prot_t</span> <span class="n">protection</span><span class="p">;</span>
    <span class="n">vm_prot_t</span> <span class="n">max_protection</span><span class="p">;</span>
    <span class="n">vm_inherit_t</span> <span class="n">inheritance</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">wired_count</span><span class="p">;</span>
    <span class="n">vm_pindex_t</span> <span class="n">lastr</span><span class="p">;</span>
<span class="p">};</span>
</pre></td></tr></tbody></table></code></div></div>

<p>What matters most is the <code class="language-plaintext highlighter-rouge">vm_prot_t protection</code>, which holds the current page protection. It can be <code class="language-plaintext highlighter-rouge">PROT_READ</code>, <code class="language-plaintext highlighter-rouge">PROT_WRITE</code>, <code class="language-plaintext highlighter-rouge">PROT_EXEC</code>, or a combination of them. As mentioned before, the kernel enforces only <code class="language-plaintext highlighter-rouge">PROT_READ|PROT_WRITE</code> as the maximum for requested pages from usermode.</p>

<p>But with the RW primitives and access to this data structure, one can simply add <code class="language-plaintext highlighter-rouge">PROT_EXEC</code> to any page they want. I’ve wrapped this idea in my <a href="https://github.com/buzzer-re/playstation_research_utils/blob/863e832606636e978a69f8557f0db782b9acdcc7/ps5_proc_structure/src/proc.c#L76">proc</a> wrapper, which can be used to modify any usermode page protection bit. This was also implemented in the <a href="https://github.com/ps5-payload-dev/sdk/blob/c028c113330c7da62bf50890ea085e2ef6760a2c/crt/kernel.c#L1201">SDK</a>. Initially, the SDK only used the double-linked list fields to perform a simple linear search, which was sufficient most of the time. My <a href="https://github.com/ps5-payload-dev/sdk/commit/45ba1ca929dcfeae46b84a053d0b31725107a78b">contribution</a> was to add the Binary Search Tree algorithm with the correct offsets to increase the page search/patch speed. Nevertheless, with all this shared, the result is that we are now able to:</p>

<ul>
  <li>Jailbreak the process to give it debug capabilities</li>
  <li>Request usermode executable memory</li>
</ul>

<p>The missing piece is how to combine both of these to map an ELF inside another process’s userspace. This is achieved by using the <a href="https://github.com/ps5-payload-dev/elfldr">elfldr</a>.</p>

<h1 id="mapping-an-elf-in-the-remote-process">Mapping an ELF in the remote process</h1>

<p>Unlike Windows, where API calls like<code class="language-plaintext highlighter-rouge">VirtualAllocEx</code> (allocate memory inside another process) exist, this is not true in the Unix world. You don’t have access to such functions to do that you need to instrument the target process to ask it nicely to do it.</p>

<p>Behind the scenes, the <a href="https://github.com/ps5-payload-dev/elfldr">elfldr</a> uses a ptrace wrapper that can call remote functions. Basically, if you can pause the target process thread, save its state, specifically craft the RIP and the necessary arguments to another address, and resume it, this will result in a call to any remote function. You can check its implementation <a href="https://github.com/ps5-payload-dev/elfldr/blob/fe0b8bb337bd243ffd2ca073d702902cd70fb7e4/pt.c#L213">here</a>.</p>

<p>I’ve modified the elfldr source code to only map the ELF inside the process space (nothing more), giving me the opportunity to call it inside another thread. What my injector does is the following:</p>

<ul>
  <li>Use a slightly modified version of the elfldr to map the ELF correctly within the target memory space</li>
  <li>Write a small shellcode in the target process to call the pthread_create function, issue an int3 to notify the injector</li>
  <li>Detach from the process</li>
  <li>The ELF is now running in a different thread</li>
</ul>

<p>All this can be checked <a href="https://github.com/buzzer-re/NineS/blob/e8eaaa06ebc62e3f1f6ac642a0fc85417439887b/src/injector.c#L75">here</a>, but the important piece of code is:</p>

<div class="language-c highlighter-rouge"><div class="code-header">
        <span data-label-text="C"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="kt">intptr_t</span> <span class="n">entry</span> <span class="o">=</span> <span class="n">elfldr_load</span><span class="p">(</span><span class="n">proc</span><span class="o">-&gt;</span><span class="n">pid</span><span class="p">,</span> <span class="p">(</span><span class="kt">uint8_t</span><span class="o">*</span><span class="p">)</span> <span class="n">elf</span><span class="p">);</span>

<span class="p">...</span>

<span class="kt">intptr_t</span> <span class="n">args</span> <span class="o">=</span> <span class="n">elfldr_payload_args</span><span class="p">(</span><span class="n">proc</span><span class="o">-&gt;</span><span class="n">pid</span><span class="p">);</span>
<span class="n">printf</span><span class="p">(</span><span class="s">"[+] ELF entrypoint: %#02lx [+]</span><span class="se">\n</span><span class="s">[+] Payload Args: %#02lx [+]</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">entry</span><span class="p">,</span> <span class="n">args</span><span class="p">);</span>
</pre></td></tr></tbody></table></code></div></div>

<p><code class="language-plaintext highlighter-rouge">entry</code> is, as the name suggests, the entrypoint of the executable. It points to the SDK’s CRT, which needs the <code class="language-plaintext highlighter-rouge">payload_args_t</code> structure to work correctly. This structure contains important information provided by the exploit, such as the Kernel R/W primitives and some addresses. This is used by its dynamic linker to resolve necessary functions and apply necessary process permission patches to work properly. The injected code that bootstraps the ELF is simple; here’s its core:</p>

<div class="language-c highlighter-rouge"><div class="code-header">
        <span data-label-text="C"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="kt">int</span> <span class="nf">__attribute__</span><span class="p">((</span><span class="n">section</span><span class="p">(</span><span class="s">".stager_shellcode$1"</span><span class="p">)))</span>  <span class="n">stager</span><span class="p">(</span><span class="n">SCEFunctions</span><span class="o">*</span> <span class="n">functions</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">pthread_t</span> <span class="kr">thread</span><span class="p">;</span>
    <span class="n">functions</span><span class="o">-&gt;</span><span class="n">pthread_create_ptr</span><span class="p">(</span><span class="o">&amp;</span><span class="kr">thread</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">(</span><span class="o">*</span><span class="p">)(</span><span class="kt">void</span> <span class="o">*</span><span class="p">))</span> <span class="n">functions</span><span class="o">-&gt;</span><span class="n">elf_main</span><span class="p">,</span> <span class="n">functions</span><span class="o">-&gt;</span><span class="n">payload_args</span><span class="p">);</span>

    <span class="n">asm</span><span class="p">(</span><span class="s">"int3"</span><span class="p">);</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>t’s very similar to what you would expect in environments like Windows; the main difference is the existence of the <code class="language-plaintext highlighter-rouge">asm("int3")</code>, which, as mentioned before, serves to notify the injector that it’s time to detach (it also significantly speeds up execution). With all that, the ELF is now successfully running on any target process.</p>

<h1 id="example-injecting-an-elf-in-the-ui">Example: Injecting an ELF in the UI</h1>

<p>As an example, the following hello world will be executed inside the <code class="language-plaintext highlighter-rouge">SceShellUI</code> process, which is the entire PS5’s UI process.</p>

<div class="language-c highlighter-rouge"><div class="code-header">
        <span data-label-text="C"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;ps5/klog.h&gt;</span><span class="cp">
</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> 
<span class="p">{</span>
  <span class="n">klog_printf</span><span class="p">(</span><span class="s">"Hello from PID %d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">getpid</span><span class="p">());</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

</pre></td></tr></tbody></table></code></div></div>
<p>I’ve created <a href="https://github.com/buzzer-re/NineS">9S</a> as a server running on port 9033. It expects the following struct as an input argument:</p>

<div class="language-c highlighter-rouge"><div class="code-header">
        <span data-label-text="C"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="k">typedef</span> <span class="k">struct</span> <span class="n">__injector_data_t</span>
<span class="p">{</span>
    <span class="kt">char</span> <span class="n">proc_name</span><span class="p">[</span><span class="n">MAX_PROC_NAME</span><span class="p">];</span>
    <span class="n">Elf64_Ehdr</span> <span class="n">elf_header</span><span class="p">;</span>
<span class="p">}</span> <span class="n">injector_data_t</span><span class="p">;</span>
</pre></td></tr></tbody></table></code></div></div>

<p>To make life easier, I created a simple Python <a href="https://github.com/buzzer-re/NineS/blob/main/send_injection_elf.py">script</a> to send any ELF file to it. It can be used as:</p>

<blockquote>
  <p>python3 ./send_injection_elf.py SceShellUI hello_world.elf IP</p>
</blockquote>

<p>First, let’s check the SceShellUI PID to make sure the injection works:</p>

<div class="table-wrapper"><table>
  <thead>
    <tr>
      <th style="text-align: center"><a href="/assets/images/playstation-5-elf-injection/pid_check.png" class="popup img-link "><img data-src="/assets/images/playstation-5-elf-injection/pid_check.png" alt="" class="lazyload" data-proofer-ignore></a></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">PID check</td>
    </tr>
  </tbody>
</table></div>

<p>Now, let’s inject the ELF and see if it’s really running inside the target process:</p>

<div class="table-wrapper"><table>
  <tbody>
    <tr>
      <td><a href="/assets/images/playstation-5-elf-injection/inject_example.png" class="popup img-link "><img data-src="/assets/images/playstation-5-elf-injection/inject_example.png" alt="" class="lazyload" data-proofer-ignore></a></td>
    </tr>
    <tr>
      <td>ELF injection successfully</td>
    </tr>
  </tbody>
</table></div>

<h1 id="conclusion">Conclusion</h1>

<p>This concludes this article. I wrote this injector a while ago and didn’t plan to write about it, but recently, after talking with a few friends about knowledge sharing, I realized that this type of material is essential. It’s not entirely specific to the PS5 and has a lot to do with OS internals, such as those in FreeBSD.</p>

<p>Also, I’ve been using this tool extensively this past year, especially for debugging, experimentation, and reverse engineering projects. If I’m using it that much, why can’t someone else use it too?</p>

<h1 id="references">References</h1>

<p>There are many references I’ve used, I may miss some, but here’s all the material I used:</p>

<ul>
  <li><a href="https://github.com/freebsd/freebsd-src">FreeBSD source code</a></li>
  <li><a href="https://github.com/ps5-payload-dev/elfldr">elfldr</a></li>
  <li><a href="https://github.com/ps5-payload-dev/sdk">SDK</a></li>
  <li><a href="https://github.com/OpenOrbis/mira-project">Mira</a></li>
  <li><a href="https://github.com/ps5-payload-dev/gdbsrv">gdbsrv</a></li>
</ul>

<p>Also, after this tool’s publication, a friend of mine wrote the entire ptrace instrumentation tool, inspired on the originally written for FreeBSD/PS5, for a cool Linux project named <a href="https://github.com/rem0obb/plinux">plinux</a>.</p>

</div>

<div class="post-tail-wrapper text-muted">

  <!-- categories -->
  
  <div class="post-meta mb-3">
    <i class="far fa-folder-open fa-fw mr-1"></i>
    
      <a href='/categories/console-hacking/'>Console Hacking</a>
  </div>
  

  <!-- tags -->
  
  <div class="post-tags">
    <i class="fa fa-tags fa-fw mr-1"></i>
      
      <a href="/tags/reverse-engineering/"
          class="post-tag no-text-decoration" >Reverse engineering</a>
      
      <a href="/tags/ps5/"
          class="post-tag no-text-decoration" >PS5</a>
      
      <a href="/tags/programming/"
          class="post-tag no-text-decoration" >Programming</a>
      
      <a href="/tags/freebsd/"
          class="post-tag no-text-decoration" >FreeBSD</a>
      
  </div>
  

  <div class="post-tail-bottom
    d-flex justify-content-between align-items-center mt-3 pt-5 pb-2">
    <div class="license-wrapper">

      

        

        This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.

      
    </div>

    <!--
 Post sharing snippet
-->

<div class="share-wrapper">
  <span class="share-label text-muted mr-1">Share</span>
  <span class="share-icons">
    
    
    

    
      
        <a href="https://twitter.com/intent/tweet?text=Usermode%20ELF%20injection%20on%20the%20PlayStation%205%20-%20Reversing%20codes&url=https%3A%2F%2Freversing.codes%2Fposts%2FPlayStation-5-ELF-Injection%2F" data-toggle="tooltip" data-placement="top"
          title="Twitter" target="_blank" rel="noopener" aria-label="Twitter">
          <i class="fa-fw fab fa-twitter"></i>
        </a>
    
      
        <a href="https://www.facebook.com/sharer/sharer.php?title=Usermode%20ELF%20injection%20on%20the%20PlayStation%205%20-%20Reversing%20codes&u=https%3A%2F%2Freversing.codes%2Fposts%2FPlayStation-5-ELF-Injection%2F" data-toggle="tooltip" data-placement="top"
          title="Facebook" target="_blank" rel="noopener" aria-label="Facebook">
          <i class="fa-fw fab fa-facebook-square"></i>
        </a>
    
      
        <a href="https://t.me/share/url?url=https%3A%2F%2Freversing.codes%2Fposts%2FPlayStation-5-ELF-Injection%2F&text=Usermode%20ELF%20injection%20on%20the%20PlayStation%205%20-%20Reversing%20codes" data-toggle="tooltip" data-placement="top"
          title="Telegram" target="_blank" rel="noopener" aria-label="Telegram">
          <i class="fa-fw fab fa-telegram"></i>
        </a>
    

    <i id="copy-link" class="fa-fw fas fa-link small"
        data-toggle="tooltip" data-placement="top"
        title="Copy link"
        data-title-succeed="Link copied successfully!">
    </i>

  </span>
</div>


  </div><!-- .post-tail-bottom -->

</div><!-- div.post-tail-wrapper -->


      
    
    

    </div>
  </div> <!-- #core-wrapper -->

  <!-- panel -->
  <div id="panel-wrapper" class="col-xl-3 pl-2 text-muted">

    <div class="access">
      















  <div id="access-lastmod" class="post">
    <div class="panel-heading">Recently Updated</div>
    <ul class="post-content pl-0 pb-1 ml-1 mt-2">
      
        
        
        
      <li><a href="/posts/PlayStation-5-ELF-Injection/">Usermode ELF injection on the PlayStation 5</a></li>
      
        
        
        
      <li><a href="/posts/ps4-kernel-patching-guide/">How to patch the running PlayStation 4 kernel</a></li>
      
        
        
        
      <li><a href="/posts/Stop-Using-GetProcAddress-And-Let-The-Linker/">Quick Tip: Stop Using GetProcAddress and Let the Linker Do the Job for You</a></li>
      
        
        
        
      <li><a href="/posts/Manual-unpacking-in-details/">Manual Unpacking in Details</a></li>
      
        
        
        
      <li><a href="/posts/Manipulating-elf-with-felf/">Manipulating elf files in C++ using felf</a></li>
      
    </ul>
  </div> <!-- #access-lastmod -->



      















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <div id="access-tags">
    <div class="panel-heading">Trending Tags</div>
    <div class="d-flex flex-wrap mt-3 mb-1 mr-3">

    
      
      <a class="post-tag" href="/tags/programming/">Programming</a>
    
      
      <a class="post-tag" href="/tags/reverse-engineering/">Reverse engineering</a>
    
      
      <a class="post-tag" href="/tags/malware-research/">Malware Research</a>
    
      
      <a class="post-tag" href="/tags/ctf/">ctf</a>
    
      
      <a class="post-tag" href="/tags/windows-internals/">Windows Internals</a>
    
      
      <a class="post-tag" href="/tags/freebsd/">FreeBSD</a>
    
      
      <a class="post-tag" href="/tags/malware-analysis/">Malware analysis</a>
    
      
      <a class="post-tag" href="/tags/malware-research/">Malware research</a>
    
      
      <a class="post-tag" href="/tags/network-analysis/">Network analysis</a>
    
      
      <a class="post-tag" href="/tags/obfuscation-analysis/">obfuscation analysis</a>
    

    </div>
  </div>


    </div>

    
      
      



  <div id="toc-wrapper" class="pl-0 pr-4 mb-5">
    <div class="panel-heading pl-3 pt-2 mb-2">Contents</div>
    <nav id="toc"></nav>
  </div>

  <!-- toc.js will be loaded at medium priority -->
  <script src="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.js"></script>


    
  </div>

</div>

<!-- tail -->

<div class="row">
  <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4 mt-5">
    
      
      <!--
 Recommend the other 3 posts according to the tags and categories of the current post,
 if the number is not enough, use the other latest posts to supplement.
-->

<!-- The total size of related posts  -->


<!-- An random integer that bigger than 0  -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy}  -->








  

  
    
  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  








<!-- Fill with the other newlest posts  -->





  <div id="related-posts" class="mb-2 mb-sm-4">
    <h3 class="pt-2 mb-4 ml-1"
      data-toc-skip>Further Reading</h3>
    <div class="card-deck mb-4">
    
      
      
      <div class="card">
        <a href="/posts/Code-it-flare-7/">
          <div class="card-body">
            <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em class="small"
    data-ts="1603495416"
    data-df="ll"
    >
  Oct 23, 2020
</em>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>The Flare 7th AutoIT challenge</h3>
            <div class="text-muted small">
              <p>
                





                The 7th challenge of Flare-On CTF, give to us a QR code generator software that are fully obfuscated, the fun part of this challenge was interpret, analyse and deobfuscate core components of the so...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/posts/VBA-Stomping-flare/">
          <div class="card-body">
            <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em class="small"
    data-ts="1603495416"
    data-df="ll"
    >
  Oct 23, 2020
</em>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>VBA Stomping: The macro hidden in plain sight</h3>
            <div class="text-muted small">
              <p>
                





                At Flare-on 7th there was a very interesting malware analysis challenge that envolved a very unique hide technique for malicious Macros. This technique is called VBA Stomp, this works by hiding the...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/posts/Retrieving-the-exfiltrated-flag-flareon7/">
          <div class="card-body">
            <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em class="small"
    data-ts="1603495536"
    data-df="ll"
    >
  Oct 23, 2020
</em>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Data exfiltration: From shellcode to flag</h3>
            <div class="text-muted small">
              <p>
                





                At Flare 7th edition, my favorite challenge was re_crowd, this challenge was really close to a very real world scenario, with just an pcap we are able to understand how the company was attacked, wh...
              </p>
            </div>
          </div>
        </a>
      </div>
    
    </div> <!-- .card-deck -->
  </div> <!-- #related-posts -->


    
      
      <!--
  Navigation buttons at the bottom of the post.
-->

<div class="post-navigation d-flex justify-content-between">
  
  <a href="/posts/ps4-kernel-patching-guide/" class="btn btn-outline-primary"
    prompt="Older">
    <p>How to patch the running PlayStation 4 kernel</p>
  </a>
  

  
  <div class="btn btn-outline-primary disabled"
    prompt="Newer">
    <p>-</p>
  </div>
  

</div>

    
      
      <!--  The comments switcher -->


    
  </div>
</div>


      </div>

      <!--
  The Search results
-->
<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-12 col-sm-11 post-content">
    <div id="search-hints">
      















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <div id="access-tags">
    <div class="panel-heading">Trending Tags</div>
    <div class="d-flex flex-wrap mt-3 mb-1 mr-3">

    
      
      <a class="post-tag" href="/tags/programming/">Programming</a>
    
      
      <a class="post-tag" href="/tags/reverse-engineering/">Reverse engineering</a>
    
      
      <a class="post-tag" href="/tags/malware-research/">Malware Research</a>
    
      
      <a class="post-tag" href="/tags/ctf/">ctf</a>
    
      
      <a class="post-tag" href="/tags/windows-internals/">Windows Internals</a>
    
      
      <a class="post-tag" href="/tags/freebsd/">FreeBSD</a>
    
      
      <a class="post-tag" href="/tags/malware-analysis/">Malware analysis</a>
    
      
      <a class="post-tag" href="/tags/malware-research/">Malware research</a>
    
      
      <a class="post-tag" href="/tags/network-analysis/">Network analysis</a>
    
      
      <a class="post-tag" href="/tags/obfuscation-analysis/">obfuscation analysis</a>
    

    </div>
  </div>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>


    </div> <!-- #main-wrapper -->

    <!-- The Footer -->

<footer>
  <div class="container pl-lg-4 pr-lg-4">
    <div class="d-flex justify-content-between align-items-center text-muted ml-md-3 mr-md-3">
      <div class="footer-left">
        <p class="mb-0">
          © 2025
          <a href="https://github.com/buzzer-re">Buzzer</a>.
          
          <span data-toggle="tooltip" data-placement="top"
            title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span>
          
        </p>
      </div>

      <div class="footer-right">
        <p class="mb-0">Using the <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> theme <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a>.
        </p>
      </div>
    </div>
  </div>
</footer>


    

    <div id="mask"></div>

    <a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button">
      <i class="fas fa-angle-up"></i>
    </a>

    
      <div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true"
        data-animation="true" data-autohide="false">
        <div class="toast-header">
          <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="toast-body text-center pt-0">
          <p class="pl-2 pr-2 mb-3">A new version of content is available.</p>
          <button type="button" class="btn btn-primary" aria-label="Update">
            Update
          </button>
        </div>
      </div>
    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script>

<script>
SimpleJekyllSearch({
  searchInput: document.getElementById('search-input'),
  resultsContainer: document.getElementById('search-results'),
  json: '/assets/js/data/search.json',
  searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0">  <a href="{url}">{title}</a>  <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">    {categories}    {tags}  </div>  <p>{snippet}</p></div>',
  noResultsText: '<p class="mt-5">Oops! No results found.</p>',
  templateMiddleware: function(prop, value, template) {
    if (prop === 'categories') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
      }
    }

    if (prop === 'tags') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
      }
    }
  }
});
</script>


    <!-- JS selector for site. -->

<!-- layout specified -->


  



  <!-- image lazy-loading & popup & clipboard -->
  

  







  
    

    

  



  
    

    

  



  
    

    

  




  <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js"></script>





  

  

  







  
    

    

  



  
    

    

  



  
    

    

  



  
    

    

  




  <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1.11.6/dayjs.min.js,npm/dayjs@1.11.6/locale/en.min.js,npm/dayjs@1.11.6/plugin/relativeTime.min.js,npm/dayjs@1.11.6/plugin/localizedFormat.min.js"></script>







<script defer src="/assets/js/dist/post.min.js"></script>



<!-- commons -->

<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>




  </body>

</html>

